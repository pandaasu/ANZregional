(function(a){a.widget("hik.jtable",{options:{actions:{},fields:{},animationsEnabled:true,defaultDateFormat:"yy-mm-dd",dialogShowEffect:"fade",dialogHideEffect:"fade",showCloseButton:false,useReprocessRow:false,closeRequested:function(b,c){},formCreated:function(b,c){},formSubmitting:function(b,c){},formClosed:function(b,c){},loadingRecords:function(b,c){},recordsLoaded:function(b,c){},rowInserted:function(b,c){},rowsRemoved:function(b,c){},messages:{serverCommunicationError:"An error occured while communicating to the server.",loadingMessage:"Loading records...",noDataAvailable:"No data available!",areYouSure:"Are you sure?",save:"Save",saving:"Saving",cancel:"Cancel",error:"Error",close:"Close",cannotLoadOptionsFor:"Can not load options for field {0}"}},_$mainContainer:null,_$table:null,_$tableBody:null,_$tableRows:null,_$bottomPanel:null,_$busyDiv:null,_$busyMessageDiv:null,_$errorDialogDiv:null,_columnList:null,_fieldList:null,_keyField:null,_firstDataColumnOffset:0,_lastPostData:null,_cache:null,_create:function(){this._normalizeFieldsOptions();this._initializeFields();this._createFieldAndColumnList();this._createMainContainer();this._createTableTitle();this._createTable();this._createBottomPanel();this._createBusyPanel();this._createErrorDialogDiv();this._addNoDataRow()},_normalizeFieldsOptions:function(){var b=this;a.each(b.options.fields,function(d,c){b._normalizeFieldOptions(d,c)})},_normalizeFieldOptions:function(c,b){b.listClass=b.listClass||"";b.inputClass=b.inputClass||""},_initializeFields:function(){this._lastPostData={};this._$tableRows=[];this._columnList=[];this._fieldList=[];this._cache=[]},_createFieldAndColumnList:function(){var b=this;a.each(b.options.fields,function(c,d){b._fieldList.push(c);if(d.key==true){b._keyField=c}if(d.list!=false&&d.type!="hidden"){b._columnList.push(c)}})},_createMainContainer:function(){this._$mainContainer=a('<div class="jtable-main-container"></div>').appendTo(this.element)},_createTableTitle:function(){var b=this;if(!b.options.title){return}var c=a('<div class="jtable-title"></div>').appendTo(b._$mainContainer);a('<div class="jtable-title-text"></div>').appendTo(c).append(b.options.title);if(b.options.showCloseButton){a('<button class="jtable-command-button jtable-close-button" title="'+b.options.messages.close+'"><span>'+b.options.messages.close+"</span></button>").appendTo(c).click(function(d){d.preventDefault();d.stopPropagation();b._onCloseRequested()})}},_createTable:function(){this._$table=a('<table class="jtable"></table>').appendTo(this._$mainContainer);this._createTableHead();this._createTableBody()},_createTableHead:function(){var b=a("<thead></thead>").appendTo(this._$table);this._addRowToTableHead(b)},_addRowToTableHead:function(b){var c=a("<tr></tr>").appendTo(b);this._addColumnsToHeaderRow(c)},_addColumnsToHeaderRow:function(d){for(var b=0;b<this._columnList.length;b++){var e=this._columnList[b];var c=this._createHeaderCellForField(e,this.options.fields[e]);c.data("fieldName",e).appendTo(d)}},_createHeaderCellForField:function(d,c){c.width=c.width||"10%";if(d=="Reprocess"&&this.options.useReprocessRow){var b=a('<th class="jtable-column-header" style="width:'+c.width+'"><div class="jtable-column-header-container"><span class="jtable-column-header-text"></span></div></th>').data("fieldName",d);a("<button>Reprocess</button>").attr("id","btnReprocess").click(this.options.actions.reprocess).appendTo(b.find(".jtable-column-header-text"));return b}else{return a('<th class="jtable-column-header" style="width:'+c.width+'"><div class="jtable-column-header-container"><span class="jtable-column-header-text">'+c.title+"</span></div></th>").data("fieldName",d)}},_createEmptyCommandHeader:function(){return a('<th class="jtable-command-column-header" style="width:1%"></th>')},_createTableBody:function(){this._$tableBody=a("<tbody></tbody>").appendTo(this._$table)},_createBottomPanel:function(){this._$bottomPanel=a('<div class="jtable-bottom-panel"></div>').appendTo(this._$mainContainer);this._$pagingLeftArea=a('<div class="jtable-left-area"></div>').appendTo(this._$bottomPanel);this._$bottomPanel.append('<div class="jtable-middle-area"></div>');this._$pagingRightArea=a('<div class="jtable-right-area"></div>').appendTo(this._$bottomPanel)},_createBusyPanel:function(){this._$busyMessageDiv=a('<div class="jtable-busy-message"></div>').prependTo(this._$mainContainer);this._$busyDiv=a('<div class="jtable-busy-panel-background"></div>').prependTo(this._$mainContainer);this._hideBusy()},_createErrorDialogDiv:function(){var b=this;b._$errorDialogDiv=a("<div></div>").appendTo(b._$mainContainer);b._$errorDialogDiv.dialog({autoOpen:false,show:b.options.dialogShowEffect,hide:b.options.dialogHideEffect,modal:true,title:b.options.messages.error,buttons:[{text:b.options.messages.close,click:function(){b._$errorDialogDiv.dialog("close")}}]})},load:function(b,c){this._lastPostData=b;this._reloadTable(c)},reload:function(b){this._reloadTable(b)},destroy:function(){this.element.empty();a.Widget.prototype.destroy.call(this)},_reloadTable:function(d){var b=this;b._showBusy(b.options.messages.loadingMessage);var c=b._createRecordLoadUrl();b._onLoadingRecords();b._performAjaxCall(c,b._lastPostData,true,function(e){b._hideBusy();if(e.Result!="OK"){b._showError(e.Message);return}b._removeAllRows("reloading");b._addRecordsToTable(e.Records);b._onRecordsLoaded(e);if(d){d()}},function(){b._hideBusy();b._showError(b.options.messages.serverCommunicationError)})},_createRecordLoadUrl:function(){return this.options.actions.listAction},_createRowFromRecord:function(c){var b=a("<tr></tr>").data("record",c);this._addCellsToRowUsingRecord(b);return b},_addCellsToRowUsingRecord:function(b){for(var c=0;c<this._columnList.length;c++){this._createCellForRecordField(b.data("record"),this._columnList[c]).appendTo(b)}},_createCellForRecordField:function(b,c){return a('<td class="'+this.options.fields[c].listClass+'"></td>').append((this._getDisplayTextForRecordField(b,c)||""))},_addRecordsToTable:function(c){var b=this;if(this.options.useReprocessRow){var g=a('<tr class="reprocessRow"></tr>').data("record",null);for(var d=0;d<this._columnList.length-1;d++){var j=this._columnList[d];var h=this.options.fields[j];var e=a('<td class="'+h.listClass+'"></td>').appendTo(g);if(h.visibility=="hidden"){e.hide()}}var f=a("<td id='selectCell'>Select: <span id='selectAll'>All</span> | <span id='selectNone'>None</span></td>");f.find("#selectAll").click(this.options.actions.selectAll);f.find("#selectNone").click(this.options.actions.selectNone);f.appendTo(g);b._addRowToTable(g)}a.each(c,function(k,i){b._addRowToTable(b._createRowFromRecord(i))});b._refreshRowStyles()},_addRowToTable:function(e,d,b,f){var c=this;if(b!=true){b=false}if(f!=false){f=true}if(this._$tableRows.length<=0){this._removeNoDataRow()}d=this._normalizeNumber(d,0,this._$tableRows.length,this._$tableRows.length);if(d==this._$tableRows.length){this._$tableBody.append(e);this._$tableRows.push(e)}else{if(d==0){this._$tableBody.prepend(e);this._$tableRows.unshift(e)}else{this._$tableRows[d-1].after(e);this._$tableRows.splice(d,0,e)}}this._onRowInserted(e,b);if(b==true){c._refreshRowStyles();if(c.options.animationsEnabled&&f){c._showNewRowAnimation(e)}}},_showNewRowAnimation:function(b){b.addClass("jtable-row-created","slow","",function(){b.removeClass("jtable-row-created",5000)})},_removeRowsFromTable:function(c,d){var b=this;if(c.length<=0){return}c.remove();c.each(function(){b._$tableRows.splice(b._findRowIndex(a(this)),1)});b._onRowsRemoved(c,d);if(b._$tableRows.length==0){b._addNoDataRow()}b._refreshRowStyles()},_findRowIndex:function(b){return this._findIndexInArray(b,this._$tableRows,function(d,c){return d.data("record")==c.data("record")})},_removeAllRows:function(c){if(this._$tableRows.length<=0){return}var b=this._$tableBody.find("tr");this._$tableBody.empty();this._$tableRows=[];this._onRowsRemoved(b,c);this._addNoDataRow()},_addNoDataRow:function(){var b=this._$table.find("thead th").length;a('<tr class="jtable-no-data-row"></tr>').append('<td colspan="'+b+'">'+this.options.messages.noDataAvailable+"</td>").appendTo(this._$tableBody);a("#jtable-result-count").html("&nbsp;")},_removeNoDataRow:function(){this._$tableBody.find(".jtable-no-data-row").remove()},_refreshRowStyles:function(){for(var b=0;b<this._$tableRows.length;b++){if(b%2==0){this._$tableRows[b].addClass("jtable-row-even")}else{this._$tableRows[b].removeClass("jtable-row-even")}}},_getDisplayTextForRecordField:function(c,f){var e=this.options.fields[f];var d=c[f];if(e.display){return e.display({record:c})}if(e.type=="date"){return this._getDisplayTextForDateRecordField(e,d)}else{if(e.type=="checkbox"){return this._getCheckBoxTextForFieldByValue(f,d)}else{if(e.options){var b=this._getOptionsWithCaching(f)[d];return b}else{return d}}}},_getDisplayTextForDateRecordField:function(e,d){if(!d){return""}var b=e.displayFormat||this.options.defaultDateFormat;var c=this._parseDate(d);return a.datepicker.formatDate(b,c)},_parseDate:function(b){if(b.indexOf("Date")>=0){return new Date(parseInt(b.substr(6)))}else{if(b.length==10){return new Date(parseInt(b.substr(0,4)),parseInt(b.substr(5,2))-1,parseInt(b.substr(8,2)))}else{if(b.length==19){return new Date(parseInt(b.substr(0,4)),parseInt(b.substr(5,2))-1,parseInt(b.substr(8,2)),parseInt(b.substr(11,2)),parseInt(b.substr(14,2)),parseInt(b.substr(17,2)))}else{this._logWarn("Given date is no properly formatted: "+b);return new Date()}}}},_showError:function(b){this._$errorDialogDiv.html(b).dialog("open")},_showBusy:function(b){if(!this._$busyMessageDiv.is(":visible")){this._$busyDiv.width(this._$mainContainer.width());this._$busyDiv.height(this._$mainContainer.height());this._$busyDiv.show();this._$busyMessageDiv.show()}this._$busyMessageDiv.html(b)},_hideBusy:function(){this._$busyDiv.hide();this._$busyMessageDiv.html("").hide()},_isBusy:function(){return this._$busyMessageDiv.is(":visible")},_performAjaxCall:function(d,b,e,f,c){a.ajax({url:d,type:"POST",dataType:"json",data:b,async:e,success:function(g){f(g)},error:function(){c()}})},getRowByKey:function(c){for(var b=0;b<this._$tableRows.length;b++){if(c==this._$tableRows[b].data("record")[this._keyField]){return this._$tableRows[b]}}return null},_onLoadingRecords:function(){this._trigger("loadingRecords",null,{})},_onRecordsLoaded:function(b){this._trigger("recordsLoaded",null,{records:b.Records,serverResponse:b})},_onRowInserted:function(c,b){this._trigger("rowInserted",null,{row:c,record:c.data("record"),isNewRow:b})},_onRowsRemoved:function(b,c){this._trigger("rowsRemoved",null,{rows:b,reason:c})},_onCloseRequested:function(){this._trigger("closeRequested",null,{})}})}(jQuery));(function(a){a.extend(true,a.hik.jtable.prototype,{_getPropertyOfObject:function(e,c){if(c.indexOf(".")<0){return e[c]}else{var b=c.substring(0,c.indexOf("."));var d=c.substring(c.indexOf(".")+1);return this._getPropertyOfObject(e[b],d)}},_setPropertyOfObject:function(g,e,d){var b=this;if(e.indexOf(".")<0){g[e]=d}else{var c=e.substring(0,e.indexOf("."));var f=e.substring(e.indexOf(".")+1);b._setPropertyOfObject(g[c],f,d)}},_insertToArrayIfDoesNotExists:function(c,b){if(a.inArray(b,c)<0){c.push(b)}},_findIndexInArray:function(d,e,c){if(!c){c=function(g,f){return g==f}}for(var b=0;b<e.length;b++){if(c(d,e[b])){return b}}return -1},_normalizeNumber:function(e,d,b,c){if(e==undefined||e==null){return c}if(e<d){return d}if(e>b){return b}return e},_formatString:function(){if(arguments.length==0){return null}var d=arguments[0];for(var b=1;b<arguments.length;b++){var c="{"+(b-1)+"}";d=d.replace(c,arguments[b])}return d},_logDebug:function(b){if(!window.console){return}console.log("jTable DEBUG: "+b)},_logInfo:function(b){if(!window.console){return}console.log("jTable INFO: "+b)},_logWarn:function(b){if(!window.console){return}console.log("jTable WARNING: "+b)},_logError:function(b){if(!window.console){return}console.log("jTable ERROR: "+b)}})})(jQuery);(function(a){a.extend(true,a.hik.jtable.prototype,{_submitFormUsingAjax:function(c,d,e,b){this._performAjaxCall(c,d,true,e,b)},_createInputLabelForRecordField:function(b){return a('<div class="jtable-input-label">'+this.options.fields[b].title+"</div>")},_createInputForRecordField:function(f,c,b){var d=this.options.fields[f];if(c==undefined){c=d.defaultValue}if(d.input){var e=a(d.input({value:c,record:b}));if(!e.attr("id")){e.attr("id","Edit-"+f)}return e}if(d.type=="date"){return this._createDateInputForField(d,f,c)}else{if(d.type=="textarea"){return this._createTextAreaForField(d,f,c)}else{if(d.type=="password"){return this._createPasswordInputForField(d,f,c)}else{if(d.type=="checkbox"){return this._createCheckboxForField(d,f,c)}else{if(d.options){if(d.type=="radiobutton"){return this._createRadioButtonListForField(d,f,c)}else{return this._createDropDownListForField(d,f,c)}}else{return this._createTextInputForField(d,f,c)}}}}}},_createInputForHidden:function(c,b){if(b==undefined||b==null){b=""}return a('<input type="hidden" value="'+b+'" name="'+c+'" id="Edit-'+c+'"></input>')},_createDateInputForField:function(d,f,c){var e=a('<input class="'+d.inputClass+'" id="Edit-'+f+'" type="text"'+(c!=undefined?'value="'+c+'"':"")+' name="'+f+'"></input>');var b=d.displayFormat||this.options.defaultDateFormat;e.datepicker({dateFormat:b});return a('<div class="jtable-input jtable-date-input"></div>').append(e)},_createTextAreaForField:function(c,d,b){return a('<div class="jtable-input jtable-textarea-input"><textarea class="'+c.inputClass+'" id="Edit-'+d+'" name="'+d+'">'+(b||"")+"</textarea></div>")},_createTextInputForField:function(c,d,b){return a('<div class="jtable-input jtable-text-input"><input class="'+c.inputClass+'" id="Edit-'+d+'" type="text"'+(b!=undefined?'value="'+b+'"':"")+' name="'+d+'"></input></div>')},_createPasswordInputForField:function(c,d,b){return a('<div class="jtable-input jtable-password-input"><input class="'+c.inputClass+'" id="Edit-'+d+'" type="password"'+(b!=undefined?'value="'+b+'"':"")+' name="'+d+'"></input></div>')},_createCheckboxForField:function(h,i,g){var e=this;if(g==undefined){g=g||e._getCheckBoxPropertiesForFieldByState(i,false).Value}var c=a('<div class="jtable-input jtable-checkbox-input"></div>');var b=a('<input class="'+h.inputClass+'" id="Edit-'+i+'" type="checkbox" name="'+i+'" value="'+g+'" />').appendTo(c);var f=a("<span>"+(h.formText||e._getCheckBoxTextForFieldByValue(i,g))+"</span>").appendTo(c);if(e._getIsCheckBoxSelectedForFieldByValue(i,g)){b.attr("checked","checked")}var d=function(){var j=e._getCheckBoxPropertiesForFieldByState(i,b.is(":checked"));b.attr("value",j.Value);f.html(h.formText||j.DisplayText)};b.click(function(){d()});if(h.setOnTextClick!=false){f.addClass("jtable-option-text-clickable");f.click(function(){if(b.is(":checked")){b.attr("checked",false)}else{b.attr("checked",true)}d()})}return c},_createDropDownListForField:function(f,g,e){var b=a('<div class="jtable-input jtable-dropdown-input"></div>');var d=a('<select class="'+f.inputClass+'" id="Edit-'+g+'" name='+g+"></select>").appendTo(b);var c=this._getOptionsWithCaching(g);a.each(c,function(h,i){d.append('<option value="'+h+'"'+(h==e?' selected="selected"':"")+">"+i+"</option>")});return b},_createRadioButtonListForField:function(f,g,e){var b=a('<div class="jtable-input jtable-radiobuttonlist-input"></div>');var c=this._getOptionsWithCaching(g);var d=0;a.each(c,function(k,l){var j=a('<div class="jtable-radio-input"></div>').appendTo(b);var h=a('<input type="radio" id="Edit-'+g+(d++)+'" class="'+f.inputClass+'" name="'+g+'" value="'+k+'"'+(k==e?' checked="true"':"")+" />").appendTo(j);var i=a("<span>"+l+"</span>").appendTo(j);if(f.setOnTextClick!=false){i.addClass("jtable-option-text-clickable");i.click(function(){if(!h.is(":checked")){h.attr("checked",true)}})}});return b},_getCheckBoxTextForFieldByValue:function(c,b){return this.options.fields[c].values[b]},_getIsCheckBoxSelectedForFieldByValue:function(c,b){return(this._createCheckBoxStateArrayForFieldWithCaching(c)[1].Value.toString()==b.toString())},_getCheckBoxPropertiesForFieldByState:function(c,b){return this._createCheckBoxStateArrayForFieldWithCaching(c)[(b?1:0)]},_createCheckBoxStateArrayForFieldWithCaching:function(c){var b="checkbox_"+c;if(!this._cache[b]){this._cache[b]=this._createCheckBoxStateArrayForField(c)}return this._cache[b]},_createCheckBoxStateArrayForField:function(d){var c=[];var b=0;a.each(this.options.fields[d].values,function(e,f){if(b++<2){c.push({Value:e,DisplayText:f})}});return c},_getOptionsWithCaching:function(d){var c="options_"+d;if(!this._cache[c]){var b=this.options.fields[d].options;if(typeof b=="string"){this._cache[c]=this._downloadOptions(d,b)}else{if(jQuery.isArray(b)){this._cache[c]=this._buildOptionsFromArray(b)}else{this._cache[c]=b}}}return this._cache[c]},_downloadOptions:function(e,d){var b=this;var c={};b._performAjaxCall(d,undefined,false,function(g){if(g.Result!="OK"){b._showError(g.Message);return}for(var f=0;f<g.Options.length;f++){c[g.Options[f].Value]=g.Options[f].DisplayText}},function(){var f=b._formatString(b.options.messages.cannotLoadOptionsFor,e);b._showError(f)});return c},_buildOptionsFromArray:function(c){var b={};for(var d=0;d<c.length;d++){b[c[d]]=c[d]}return b},_setEnabledOfDialogButton:function(d,b,c){if(!d){return}if(b!=false){d.removeAttr("disabled").removeClass("ui-state-disabled")}else{d.attr("disabled","disabled").addClass("ui-state-disabled")}if(c){d.find("span").text(c)}}})})(jQuery);(function(b){var a={_create:b.hik.jtable.prototype._create};b.extend(true,b.hik.jtable.prototype,{options:{recordAdded:function(c,d){},messages:{addNewRecord:"+ Add new record"}},_$addRecordDiv:null,_create:function(){a._create.apply(this,arguments);this._createAddRecordDialogDiv()},_createAddRecordDialogDiv:function(){var c=this;if(!c.options.actions.createAction){return}c._$addRecordDiv=b("<div></div>").appendTo(c._$mainContainer);c._$addRecordDiv.dialog({autoOpen:false,show:c.options.dialogShowEffect,hide:c.options.dialogHideEffect,width:"auto",minWidth:"300",modal:true,title:c.options.messages.addNewRecord,buttons:[{text:c.options.messages.cancel,click:function(){c._$addRecordDiv.dialog("close")}},{id:"AddRecordDialogSaveButton",text:c.options.messages.save,click:function(){var e=b("#AddRecordDialogSaveButton");var d=c._$addRecordDiv.find("form");if(c._trigger("formSubmitting",null,{form:d,formType:"create"})!=false){c._setEnabledOfDialogButton(e,false,c.options.messages.saving);c._saveAddRecordForm(d,e)}}}],close:function(){var d=c._$addRecordDiv.find("form").first();var e=b("#AddRecordDialogSaveButton");c._trigger("formClosed",null,{form:d,formType:"create"});c._setEnabledOfDialogButton(e,true,c.options.messages.save);d.remove()}});if(!c.options.addRecordButton){c.options.addRecordButton=c._createAddRecordButton()}c.options.addRecordButton.click(function(d){d.preventDefault();c._showAddRecordForm()})},_createAddRecordButton:function(){return b('<span class="jtable-add-record"><a href="#">'+this.options.messages.addNewRecord+"</a></span>").appendTo(this._$bottomPanel.find(".jtable-right-area"))},showCreateForm:function(){this._showAddRecordForm()},addRecord:function(d){var c=this;d=b.extend({clientOnly:false,animationsEnabled:c.options.animationsEnabled,url:c.options.actions.createAction,success:function(){},error:function(){}},d);if(!d.record){c._logWarn("options parameter in addRecord method must contain a record property.");return}if(d.clientOnly){c._addRowToTable(c._createRowFromRecord(d.record),null,true,d.animationsEnabled);d.success();return}c._submitFormUsingAjax(d.url,b.param(d.record),function(e){if(e.Result!="OK"){c._showError(e.Message);d.error(e);return}c._onRecordAdded(e);c._addRowToTable(c._createRowFromRecord(e.Record),null,true,d.animationsEnabled);d.success(e)},function(){c._showError(c.options.messages.serverCommunicationError);d.error()})},_showAddRecordForm:function(){var e=this;var c=b('<form id="jtable-create-form" class="jtable-dialog-form jtable-create-form" action="'+e.options.actions.createAction+'" method="POST"></form>');for(var f=0;f<e._fieldList.length;f++){if(e.options.fields[e._fieldList[f]].create==false){continue}if(e.options.fields[e._fieldList[f]].type=="hidden"){c.append(e._createInputForHidden(e._fieldList[f],e.options.fields[e._fieldList[f]].defaultValue));continue}var d=b('<div class="jtable-input-field-container"></div>').appendTo(c);d.append(e._createInputLabelForRecordField(e._fieldList[f]));d.append(e._createInputForRecordField(e._fieldList[f]))}e._$addRecordDiv.append(c).dialog("open");e._trigger("formCreated",null,{form:c,formType:"create"})},_saveAddRecordForm:function(c,e){var d=this;c.data("submitting",true);d._submitFormUsingAjax(c.attr("action"),c.serialize(),function(f){if(f.Result!="OK"){d._showError(f.Message);d._setEnabledOfDialogButton(e,true,d.options.messages.save);return}d._onRecordAdded(f);d._addRowToTable(d._createRowFromRecord(f.Record),null,true);d._$addRecordDiv.dialog("close")},function(){d._showError(d.options.messages.serverCommunicationError);d._setEnabledOfDialogButton(e,true,d.options.messages.save)})},_onRecordAdded:function(c){this._trigger("recordAdded",null,{record:c.Record,serverResponse:c})}})})(jQuery);(function(b){var a={_create:b.hik.jtable.prototype._create,_addColumnsToHeaderRow:b.hik.jtable.prototype._addColumnsToHeaderRow,_addCellsToRowUsingRecord:b.hik.jtable.prototype._addCellsToRowUsingRecord};b.extend(true,b.hik.jtable.prototype,{options:{recordUpdated:function(c,d){},rowUpdated:function(c,d){},messages:{editRecord:"Edit Record"}},_$editDiv:null,_$editingRow:null,_create:function(){a._create.apply(this,arguments);this._createEditDialogDiv()},_createEditDialogDiv:function(){var c=this;c._$editDiv=b("<div></div>").appendTo(c._$mainContainer);c._$editDiv.dialog({autoOpen:false,show:c.options.dialogShowEffect,hide:c.options.dialogHideEffect,width:"auto",minWidth:"300",modal:true,title:c.options.messages.editRecord,buttons:[{text:c.options.messages.cancel,click:function(){c._$editDiv.dialog("close")}},{id:"EditDialogSaveButton",text:c.options.messages.save,click:function(){var e=c._$editDiv.find("#EditDialogSaveButton");var d=c._$editDiv.find("form");if(c._trigger("formSubmitting",null,{form:d,formType:"edit"})!=false){c._setEnabledOfDialogButton(e,false,c.options.messages.saving);c._saveEditForm(d,e)}}}],close:function(){var d=c._$editDiv.find("form:first");var e=b("#EditDialogSaveButton");c._trigger("formClosed",null,{form:d,formType:"edit"});c._setEnabledOfDialogButton(e,true,c.options.messages.save);d.remove()}})},updateRecord:function(d){var c=this;d=b.extend({clientOnly:false,animationsEnabled:c.options.animationsEnabled,url:c.options.actions.updateAction,success:function(){},error:function(){}},d);var f=d.record[c._keyField];if(!d.record||!f){c._logWarn("options parameter in updateRecord method must contain a record that contains the key field property.");return}var e=c.getRowByKey(f);if(e==null){c._logWarn("Can not found any row by key: "+f);return}if(d.clientOnly){b.extend(e.data("record"),d.record);c._updateRowTexts(e);c._onRecordUpdated(e,null);if(d.animationsEnabled){c._showUpdateAnimationForRow(e)}d.success();return}c._submitFormUsingAjax(d.url,b.param(d.record),function(g){if(g.Result!="OK"){c._showError(g.Message);d.error(g);return}b.extend(e.data("record"),d.record);c._updateRowTexts(e);c._onRecordUpdated(e,g);if(d.animationsEnabled){c._showUpdateAnimationForRow(e)}d.success(g)},function(){c._showError(c.options.messages.serverCommunicationError);d.error()})},_addColumnsToHeaderRow:function(c){a._addColumnsToHeaderRow.apply(this,arguments);if(this.options.actions.updateAction!=undefined){c.append(this._createEmptyCommandHeader())}},_addCellsToRowUsingRecord:function(c){var d=this;a._addCellsToRowUsingRecord.apply(this,arguments);if(d.options.actions.updateAction!=undefined){var e=b('<td class="jtable-command-column"></td>').appendTo(c);b('<button class="jtable-command-button jtable-edit-command-button" title="'+d.options.messages.editRecord+'"><span>'+d.options.messages.editRecord+"</span></button>").appendTo(e).click(function(f){f.preventDefault();f.stopPropagation();d._showEditForm(c)})}},_showEditForm:function(j){var f=this;var c=j.data("record");var e=b('<form id="jtable-edit-form" class="jtable-dialog-form jtable-edit-form" action="'+f.options.actions.updateAction+'" method="POST"></form>');for(var g=0;g<f._fieldList.length;g++){if(f.options.fields[f._fieldList[g]].key==true){e.append(f._createInputForHidden(f._fieldList[g],c[f._fieldList[g]]));continue}if(f.options.fields[f._fieldList[g]].edit==false){continue}if(f.options.fields[f._fieldList[g]].type=="hidden"){e.append(f._createInputForHidden(f._fieldList[g],c[f._fieldList[g]]));continue}var d=b('<div class="jtable-input-field-container"></div>').appendTo(e);d.append(f._createInputLabelForRecordField(f._fieldList[g]));var h=f._getValueForRecordField(c,f._fieldList[g]);d.append(f._createInputForRecordField(f._fieldList[g],h,c))}f._$editingRow=j;f._$editDiv.append(e).dialog("open");f._trigger("formCreated",null,{form:e,formType:"edit",record:c})},_saveEditForm:function(d,e){var c=this;c._submitFormUsingAjax(d.attr("action"),d.serialize(),function(g){if(g.Result!="OK"){c._showError(g.Message);c._setEnabledOfDialogButton(e,true,c.options.messages.save);return}var f=c._$editingRow;c._updateRecordValuesFromEditForm(f.data("record"),d);c._updateRowTexts(f);c._onRecordUpdated(f,g);if(c.options.animationsEnabled){c._showUpdateAnimationForRow(f)}c._$editDiv.dialog("close")},function(){c._showError(c.options.messages.serverCommunicationError);c._setEnabledOfDialogButton(e,true,c.options.messages.save)})},_updateRecordValuesFromEditForm:function(f,n){for(var d=0;d<this._fieldList.length;d++){var l=this._fieldList[d];var j=this.options.fields[l];if(j.edit==false){continue}var k=n.find('[name="'+l+'"]');if(j.type=="date"){var m=j.displayFormat||this.options.defaultDateFormat;try{var c=b.datepicker.parseDate(m,k.val());f[l]="/Date("+c.getTime()+")/"}catch(h){f[l]="/Date("+(new Date()).getTime()+")/"}}else{if(j.options&&j.type=="radiobutton"){var g=k.filter('[checked="true"]');if(g.length){f[l]=g.val()}else{f[l]=undefined}}else{f[l]=k.val()}}}},_getValueForRecordField:function(c,f){var e=this.options.fields[f];var d=c[f];if(e.type=="date"){return this._getDisplayTextForDateRecordField(e,d)}else{return d}},_updateRowTexts:function(g){var d=g.data("record");var c=g.find("td");for(var f=0;f<this._columnList.length;f++){var e=this._getDisplayTextForRecordField(d,this._columnList[f]);c.eq(this._firstDataColumnOffset+f).html(e||"")}this._onRowUpdated(g)},_showUpdateAnimationForRow:function(c){c.stop(true,true).addClass("jtable-row-updated","slow","",function(){c.removeClass("jtable-row-updated",5000)})},_onRowUpdated:function(c){this._trigger("rowUpdated",null,{row:c,record:c.data("record")})},_onRecordUpdated:function(c,d){this._trigger("recordUpdated",null,{record:c.data("record"),row:c,serverResponse:d})}})})(jQuery);(function(b){var a={_create:b.hik.jtable.prototype._create,_addColumnsToHeaderRow:b.hik.jtable.prototype._addColumnsToHeaderRow,_addCellsToRowUsingRecord:b.hik.jtable.prototype._addCellsToRowUsingRecord};b.extend(true,b.hik.jtable.prototype,{options:{deleteConfirmation:true,recordDeleted:function(c,d){},messages:{deleteConfirmation:"This record will be deleted. Are you sure?",deleteText:"Delete",deleting:"Deleting",canNotDeletedRecords:"Can not deleted {0} of {1} records!",deleteProggress:"Deleted {0} of {1} records, processing..."}},_$deleteRecordDiv:null,_$deletingRow:null,_create:function(){a._create.apply(this,arguments);this._createDeleteDialogDiv()},_createDeleteDialogDiv:function(){var c=this;c._$deleteRecordDiv=b('<div><p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span><span class="jtable-delete-confirm-message"></span></p></div>').appendTo(c._$mainContainer);c._$deleteRecordDiv.dialog({autoOpen:false,show:c.options.dialogShowEffect,hide:c.options.dialogHideEffect,modal:true,title:c.options.messages.areYouSure,buttons:[{text:c.options.messages.cancel,click:function(){c._$deleteRecordDiv.dialog("close")}},{id:"DeleteDialogButton",text:c.options.messages.deleteText,click:function(){var d=b("#DeleteDialogButton");c._setEnabledOfDialogButton(d,false,c.options.messages.deleting);c._deleteRecordFromServer(c._$deletingRow,function(){c._removeRowsFromTableWithAnimation(c._$deletingRow);c._$deleteRecordDiv.dialog("close")},function(e){c._showError(e);c._setEnabledOfDialogButton(d,true,c.options.messages.deleteText)})}}],close:function(){var d=b("#DeleteDialogButton");c._setEnabledOfDialogButton(d,true,c.options.messages.deleteText)}})},deleteRows:function(e){var d=this;if(e.length<=0||d._isBusy()){return}if(e.length==1){d._deleteRecordFromServer(e,function(){d._removeRowsFromTableWithAnimation(e)},function(i){d._showError(i)});return}d._showBusy(d._formatString(d.options.messages.deleteProggress,0,e.length));var c=0;var g=function(){return(c>=e.length)};var f=function(){var i=e.filter(".jtable-row-ready-to-remove");if(i.length<e.length){d._showError(d._formatString(d.options.messages.canNotDeletedRecords,e.length-i.length,e.length))}if(i.length>0){d._removeRowsFromTableWithAnimation(i)}d._hideBusy()};var h=0;e.each(function(){var i=b(this);d._deleteRecordFromServer(i,function(){++h;++c;i.addClass("jtable-row-ready-to-remove");d._showBusy(d._formatString(d.options.messages.deleteProggress,h,e.length));if(g()){f()}},function(){++c;if(g()){f()}})})},deleteRecord:function(d){var c=this;d=b.extend({clientOnly:false,animationsEnabled:c.options.animationsEnabled,url:c.options.actions.deleteAction,success:function(){},error:function(){}},d);if(!d.key){c._logWarn("options parameter in deleteRecord method must contain a record key.");return}var e=c.getRowByKey(d.key);if(e==null){c._logWarn("Can not found any row by key: "+d.key);return}if(d.clientOnly){c._removeRowsFromTableWithAnimation(e,d.animationsEnabled);d.success();return}c._deleteRecordFromServer(e,function(f){c._removeRowsFromTableWithAnimation(e,d.animationsEnabled);d.success(f)},function(f){c._showError(f);d.error(f)},d.url)},_addColumnsToHeaderRow:function(c){a._addColumnsToHeaderRow.apply(this,arguments);if(this.options.actions.deleteAction!=undefined){c.append(this._createEmptyCommandHeader())}},_addCellsToRowUsingRecord:function(c){a._addCellsToRowUsingRecord.apply(this,arguments);var d=this;if(d.options.actions.deleteAction!=undefined){var e=b('<td class="jtable-command-column"></td>').appendTo(c);b('<button class="jtable-command-button jtable-delete-command-button" title="'+d.options.messages.deleteText+'"><span>'+d.options.messages.deleteText+"</span></button>").appendTo(e).click(function(f){f.preventDefault();f.stopPropagation();d._deleteButtonClickedForRow(c)})}},_deleteButtonClickedForRow:function(c){var d=this;var f;var e=d.options.messages.deleteConfirmation;if(b.isFunction(d.options.deleteConfirmation)){var g={row:c,record:c.data("record"),deleteConfirm:true,deleteConfirmMessage:e,cancel:false,cancelMessage:null};d.options.deleteConfirmation(g);if(g.cancel){if(g.cancelMessage){d._showError(g.cancelMessage)}return}e=g.deleteConfirmMessage;f=g.deleteConfirm}else{f=d.options.deleteConfirmation}if(f!=false){d._$deleteRecordDiv.find(".jtable-delete-confirm-message").html(e);d._showDeleteDialog(c)}else{d._deleteRecordFromServer(c,function(){d._removeRowsFromTableWithAnimation(c)},function(h){d._showError(h)})}},_showDeleteDialog:function(c){this._$deletingRow=c;this._$deleteRecordDiv.dialog("open")},_deleteRecordFromServer:function(c,h,g,f){var e=this;if(c.data("deleting")==true){return}c.data("deleting",true);var d={};d[e._keyField]=c.data("record")[e._keyField];e._performAjaxCall((f||e.options.actions.deleteAction),d,true,function(i){if(i.Result!="OK"){c.data("deleting",false);if(g){g(i.Message)}return}e._trigger("recordDeleted",null,{record:c.data("record"),row:c,serverResponse:i});if(h){h(i)}},function(){c.data("deleting",false);if(g){g(e.options.messages.serverCommunicationError)}})},_removeRowsFromTableWithAnimation:function(d,e){var c=this;if(e==undefined){e=c.options.animationsEnabled}if(e){d.stop(true,true).addClass("jtable-row-deleting","slow","").promise().done(function(){c._removeRowsFromTable(d,"deleted")})}else{c._removeRowsFromTable(d,"deleted")}}})})(jQuery);(function(b){var a={_create:b.hik.jtable.prototype._create,_addColumnsToHeaderRow:b.hik.jtable.prototype._addColumnsToHeaderRow,_addCellsToRowUsingRecord:b.hik.jtable.prototype._addCellsToRowUsingRecord,_onLoadingRecords:b.hik.jtable.prototype._onLoadingRecords,_onRecordsLoaded:b.hik.jtable.prototype._onRecordsLoaded,_onRowsRemoved:b.hik.jtable.prototype._onRowsRemoved};b.extend(true,b.hik.jtable.prototype,{options:{selecting:false,multiselect:false,selectingCheckboxes:false,selectOnRowClick:true,selectionChanged:function(c,d){}},_selectedRecordIdsBeforeLoad:null,_$selectAllCheckbox:null,_shiftKeyDown:false,_create:function(){if(this.options.selecting&&this.options.selectingCheckboxes){++this._firstDataColumnOffset}this._bindKeyboardEvents();a._create.apply(this,arguments)},_bindKeyboardEvents:function(){var c=this;b(document).keydown(function(d){switch(d.which){case 16:c._shiftKeyDown=true;break}}).keyup(function(d){switch(d.which){case 16:c._shiftKeyDown=false;break}})},selectedRows:function(){return this._getSelectedRows()},_addColumnsToHeaderRow:function(c){if(this.options.selecting&&this.options.selectingCheckboxes){if(this.options.multiselect){c.append(this._createSelectAllHeader())}else{c.append(this._createEmptyCommandHeader())}}a._addColumnsToHeaderRow.apply(this,arguments)},_addCellsToRowUsingRecord:function(c){if(this.options.selecting){this._makeRowSelectable(c)}a._addCellsToRowUsingRecord.apply(this,arguments)},_onLoadingRecords:function(){this._storeSelectionList();a._onLoadingRecords.apply(this,arguments)},_onRecordsLoaded:function(){this._restoreSelectionList();a._onRecordsLoaded.apply(this,arguments)},_onRowsRemoved:function(c,d){if((d!="reloading")&&this.options.selecting&&(c.filter(".jtable-row-selected").length>0)){this._onSelectionChanged()}a._onRowsRemoved.apply(this,arguments)},_createSelectAllHeader:function(){var c=this;var d=b('<th class="jtable-command-column-header jtable-column-header-selecting"></th>');var e=b('<div class="jtable-column-header-container"></div>').appendTo(d);c._$selectAllCheckbox=b('<input type="checkbox" />').appendTo(e);c._$selectAllCheckbox.click(function(){if(c._$tableRows.length<=0){c._$selectAllCheckbox.attr("checked",false);return}var f=c._$tableBody.find("tr");if(c._$selectAllCheckbox.is(":checked")){c._selectRows(f)}else{c._deselectRows(f)}c._onSelectionChanged()});return d},_storeSelectionList:function(){var c=this;if(!c.options.selecting){return}c._selectedRecordIdsBeforeLoad=[];c._getSelectedRows().each(function(){c._selectedRecordIdsBeforeLoad.push(b(this).data("record")[c._keyField])})},_restoreSelectionList:function(){var c=this;if(!c.options.selecting){return}var d=0;for(var e=(this.options.useReprocessRow)?1:0;e<c._$tableRows.length;++e){if(b.inArray(c._$tableRows[e].data("record")[c._keyField],c._selectedRecordIdsBeforeLoad)>-1){c._selectRows(c._$tableRows[e]);++d}}if(c._selectedRecordIdsBeforeLoad.length>0&&c._selectedRecordIdsBeforeLoad.length!=d){c._onSelectionChanged()}c._selectedRecordIdsBeforeLoad=[];c._refreshSelectAllCheckboxState()},_getSelectedRows:function(){return this._$tableBody.find(".jtable-row-selected")},_makeRowSelectable:function(d){var e=this;if(e.options.selectOnRowClick){d.click(function(){e._invertRowSelection(d)})}if(e.options.selectingCheckboxes){var f=b('<td class="jtable-selecting-column"></td>');var c=b('<input type="checkbox" />').appendTo(f);if(!e.options.selectOnRowClick){c.click(function(){e._invertRowSelection(d)})}d.append(f)}},_invertRowSelection:function(c){if(c.hasClass("jtable-row-selected")){this._deselectRows(c)}else{if(this._shiftKeyDown){var f=this._findRowIndex(c);var d=this._findFirstSelectedRowIndexBeforeIndex(f)+1;if(d>0&&d<f){this._selectRows(this._$tableBody.find("tr").slice(d,f+1))}else{var e=this._findFirstSelectedRowIndexAfterIndex(f)-1;if(e>f){this._selectRows(this._$tableBody.find("tr").slice(f,e+1))}else{this._selectRows(c)}}}else{this._selectRows(c)}}this._onSelectionChanged()},_findFirstSelectedRowIndexBeforeIndex:function(d){for(var c=d-1;c>=0;--c){if(this._$tableRows[c].hasClass("jtable-row-selected")){return c}}return -1},_findFirstSelectedRowIndexAfterIndex:function(d){for(var c=d+1;c<this._$tableRows.length;++c){if(this._$tableRows[c].hasClass("jtable-row-selected")){return c}}return -1},_selectRows:function(c){if(!this.options.multiselect){this._deselectRows(this._getSelectedRows())}c.addClass("jtable-row-selected");if(this.options.selectingCheckboxes){c.find("td.jtable-selecting-column input").attr("checked",true)}this._refreshSelectAllCheckboxState()},_deselectRows:function(c){c.removeClass("jtable-row-selected");if(this.options.selectingCheckboxes){c.find("td.jtable-selecting-column input").removeAttr("checked")}this._refreshSelectAllCheckboxState()},_refreshSelectAllCheckboxState:function(){if(!this.options.selectingCheckboxes||!this.options.multiselect){return}var d=this._$tableRows.length;var c=this._getSelectedRows().length;if(c==0){this._$selectAllCheckbox.prop("indeterminate",false);this._$selectAllCheckbox.attr("checked",false)}else{if(c==d){this._$selectAllCheckbox.prop("indeterminate",false);this._$selectAllCheckbox.attr("checked",true)}else{this._$selectAllCheckbox.attr("checked",false);this._$selectAllCheckbox.prop("indeterminate",true)}}},_onSelectionChanged:function(){this._trigger("selectionChanged",null,{})}})})(jQuery);(function(b){var a={load:b.hik.jtable.prototype.load,_create:b.hik.jtable.prototype._create,_createRecordLoadUrl:b.hik.jtable.prototype._createRecordLoadUrl,_addRowToTable:b.hik.jtable.prototype._addRowToTable,_removeRowsFromTable:b.hik.jtable.prototype._removeRowsFromTable,_onRecordsLoaded:b.hik.jtable.prototype._onRecordsLoaded};b.extend(true,b.hik.jtable.prototype,{options:{paging:false,pageSize:10,messages:{pagingInfo:"Results {0}-{1} of {2}"}},_$pagingListArea:null,_$pagingLeftArea:null,_$pagingRightArea:null,_totalRecordCount:0,_currentPageNo:1,_create:function(){a._create.apply(this,arguments);this._createPageListArea()},_createPageListArea:function(){if(!this.options.paging){return}this._$pagingListArea=b('<span class="jtable-page-list"></span>').prependTo(this._$bottomPanel.find(".jtable-middle-area"))},load:function(){this._currentPageNo=1;a.load.apply(this,arguments)},_createRecordLoadUrl:function(){var c=a._createRecordLoadUrl.apply(this,arguments);c=this._addPagingInfoToUrl(c,this._currentPageNo);return c},_addRowToTable:function(e,d,c){if(c&&this.options.paging){this._reloadTable();return}a._addRowToTable.apply(this,arguments)},_removeRowsFromTable:function(c,d){a._removeRowsFromTable.apply(this,arguments);if(this.options.paging){if(this._$tableRows.length<=0&&this._currentPageNo>1){--this._currentPageNo}this._reloadTable()}},_onRecordsLoaded:function(c){this._totalRecordCount=c.TotalRecordCount;this._createPagingList();a._onRecordsLoaded.apply(this,arguments)},_addPagingInfoToUrl:function(e,c){if(!this.options.paging){return e}var d=(c-1)*this.options.pageSize;var f=this.options.pageSize;return(e+(e.indexOf("?")<0?"?":"&")+"jtStartIndex="+d+"&jtPageSize="+f)},_createPagingList:function(){if(!this.options.paging||this.options.pageSize<=0){return}this._$pagingListArea.empty();this._$pagingRightArea.empty();this._$pagingLeftArea.empty();var c=this._calculatePageCount();this._createFirstAndPreviousPageButtons();this._createPageNumberButtons(this._calculatePageNumbers(c));this._createLastAndNextPageButtons(c);this._createPagingInfo();this._bindClickEventsToPageNumberButtons();if(c>1){this._$bottomPanel.show()}else{this._$bottomPanel.hide()}},_createFirstAndPreviousPageButtons:function(){if(this._currentPageNo>1){b('<span class="jtable-page-number-first">|&lt</span>').data("pageNumber",1).appendTo(this._$pagingListArea);b('<span class="jtable-page-number-previous">Previous page</span>').data("pageNumber",this._currentPageNo-1).appendTo(this._$pagingLeftArea)}},_createLastAndNextPageButtons:function(c){if(this._currentPageNo<c){b('<span class="jtable-page-number-next">Next page</span>').data("pageNumber",this._currentPageNo+1).appendTo(this._$pagingRightArea);b('<span class="jtable-page-number-last">&gt|</span>').data("pageNumber",c).appendTo(this._$pagingListArea)}},_createPageNumberButtons:function(c){var d=0;for(var e=0;e<c.length;e++){if((c[e]-d)>1){b('<span class="jtable-page-number-space">...</span>').appendTo(this._$pagingListArea)}this._createPageNumberButton(c[e]);d=c[e]}},_createPageNumberButton:function(c){b('<span class="'+(this._currentPageNo==c?"jtable-page-number-active":"jtable-page-number")+'">'+c+"</span>").data("pageNumber",c).appendTo(this._$pagingListArea)},_calculatePageCount:function(){var c=Math.floor(this._totalRecordCount/this.options.pageSize);if(this._totalRecordCount%this.options.pageSize!=0){++c}return c},_calculatePageNumbers:function(e){if(e<=6){var c=[];for(var f=1;f<=e;++f){c.push(f)}return c}else{var d=[1,2,3,e-2,e-1,e];var h=this._normalizeNumber(this._currentPageNo-1,1,e,1);var g=this._normalizeNumber(this._currentPageNo+1,1,e,1);this._insertToArrayIfDoesNotExists(d,h);this._insertToArrayIfDoesNotExists(d,this._currentPageNo);this._insertToArrayIfDoesNotExists(d,g);d.sort(function(j,i){return j-i});return d}},_createPagingInfo:function(){var e=(this._currentPageNo-1)*this.options.pageSize+1;var d=this._currentPageNo*this.options.pageSize;d=this._normalizeNumber(d,e,this._totalRecordCount,0);if(d>=e){var c=this._formatString(this.options.messages.pagingInfo,e,d,this._totalRecordCount);b("#jtable-result-count").text(c)}},_bindClickEventsToPageNumberButtons:function(){var c=this;c._$bottomPanel.find(".jtable-page-number,.jtable-page-number-previous,.jtable-page-number-next,.jtable-page-number-first,.jtable-page-number-last").click(function(f){f.preventDefault();var d=b(this);c._currentPageNo=d.data("pageNumber");c._reloadTable()})}})})(jQuery);(function(b){var a={_create:b.hik.jtable.prototype._create,_normalizeFieldOptions:b.hik.jtable.prototype._normalizeFieldOptions,_createHeaderCellForField:b.hik.jtable.prototype._createHeaderCellForField,_createRecordLoadUrl:b.hik.jtable.prototype._createRecordLoadUrl};b.extend(true,b.hik.jtable.prototype,{options:{sorting:false,defaultSorting:""},_lastSorting:"",_normalizeFieldOptions:function(d,c){a._normalizeFieldOptions.apply(this,arguments);c.sorting=(c.sorting!=false)},_createHeaderCellForField:function(e,d){var c=a._createHeaderCellForField.apply(this,arguments);if(this.options.sorting&&d.sorting){this._makeColumnSortable(c,e)}return c},_createRecordLoadUrl:function(){var c=a._createRecordLoadUrl.apply(this,arguments);c=this._addSortingInfoToUrl(c);return c},_makeColumnSortable:function(d,e){var c=this;d.addClass("jtable-column-header-sortable").click(function(f){f.preventDefault();c._sortTableByColumn(d)});if(c.options.defaultSorting.indexOf(e)>-1){if(c.options.defaultSorting.indexOf("DESC")>-1){d.addClass("jtable-column-header-sorted-desc");c._lastSorting=e+" DESC"}else{d.addClass("jtable-column-header-sorted-asc");c._lastSorting=e+" ASC"}}},_sortTableByColumn:function(c){c.siblings().removeClass("jtable-column-header-sorted-asc jtable-column-header-sorted-desc");if(c.hasClass("jtable-column-header-sorted-asc")){c.removeClass("jtable-column-header-sorted-asc").addClass("jtable-column-header-sorted-desc");this._lastSorting=c.data("fieldName")+" DESC"}else{c.removeClass("jtable-column-header-sorted-desc").addClass("jtable-column-header-sorted-asc");this._lastSorting=c.data("fieldName")+" ASC"}this._reloadTable()},_addSortingInfoToUrl:function(c){if(!this.options.sorting||this._lastSorting==""){return c}return(c+(c.indexOf("?")<0?"?":"&")+"jtSorting="+this._lastSorting)}})})(jQuery);(function(b){var a={_create:b.hik.jtable.prototype._create,_normalizeFieldOptions:b.hik.jtable.prototype._normalizeFieldOptions,_createHeaderCellForField:b.hik.jtable.prototype._createHeaderCellForField,_createCellForRecordField:b.hik.jtable.prototype._createCellForRecordField};b.extend(true,b.hik.jtable.prototype,{options:{tableId:undefined,columnResizable:true,columnSelectable:true,saveUserPreferences:true},_$columnSelectionDiv:null,_$columnResizeBar:null,_cookieKeyPrefix:null,_currentResizeArgs:null,_create:function(){a._create.apply(this,arguments);this._createColumnResizeBar();this._createColumnSelection();this._cookieKeyPrefix=this._generateCookieKeyPrefix();if(this.options.saveUserPreferences){this._loadColumnSettings()}this._normalizeColumnWidths()},_normalizeFieldOptions:function(d,c){a._normalizeFieldOptions.apply(this,arguments);if(this.options.columnResizable){c.columnResizable=(c.columnResizable!=false)}if(!c.visibility){c.visibility="visible"}},_createHeaderCellForField:function(e,d){var c=a._createHeaderCellForField.apply(this,arguments);if(this.options.columnResizable&&d.columnResizable&&(e!=this._columnList[this._columnList.length-1])){this._makeColumnResizable(c)}if(d.visibility=="hidden"){c.hide()}return c},_createCellForRecordField:function(c,f){var e=a._createCellForRecordField.apply(this,arguments);var d=this.options.fields[f];if(d.visibility=="hidden"){e.hide()}return e},changeColumnVisibility:function(d,c){this._changeColumnVisibilityInternal(d,c);this._normalizeColumnWidths();if(this.options.saveUserPreferences){this._saveColumnSettings()}},_changeColumnVisibilityInternal:function(d,c){var f=-1;if(this._columnList.indexOf){f=this._columnList.indexOf(d)}else{for(var e=0;e<this._columnList.length;e++){if(this._columnList[e]==d){f=e;break}}}if(f<0){this._logWarn('Column "'+d+'" does not exist in fields!');return}if(this._columnList.indexOf){if(["visible","hidden","fixed"].indexOf(c)<0){this._logWarn('Visibility value is not valid: "'+c+'"! Options are: visible, hidden, fixed.');return}}else{if(c!="visible"&&c!="hidden"&&c!="fixed"){this._logWarn('Visibility value is not valid: "'+c+'"! Options are: visible, hidden, fixed.');return}}var h=this.options.fields[d];if(h.visibility==c){return}var g=this._firstDataColumnOffset+f+1;if(h.visibility!="hidden"&&c=="hidden"){this._$table.find("th:nth-child("+g+"),td:nth-child("+g+")").hide()}else{if(h.visibility=="hidden"&&c!="hidden"){this._$table.find("th:nth-child("+g+"),td:nth-child("+g+")").show().css("display","table-cell")}}h.visibility=c},_createColumnSelection:function(){var c=this;this._$columnSelectionDiv=b('<div class="jtable-column-selection-container"></div>').appendTo(c._$mainContainer);this._$table.find("thead").bind("contextmenu",function(d){if(!c.options.columnSelectable){return}d.preventDefault();b('<div class="jtable-contextmenu-overlay"></div>').click(function(){b(this).remove();c._$columnSelectionDiv.hide()}).bind("contextmenu",function(){return false}).appendTo(document.body);c._fillColumnSelection();c._$columnSelectionDiv.css({left:d.pageX-b(document).scrollLeft(),top:d.pageY-b(document).scrollTop()}).show()})},_fillColumnSelection:function(){var f=this;var e=b('<ul class="jtable-column-select-list"></ul>');for(var g=0;g<this._columnList.length;g++){var d=this._columnList[g];var k=this.options.fields[d];var j=b("<li></li>").appendTo(e);var c=b('<label for="'+d+'"><span>'+(k.title||d)+"</span><label>").appendTo(j);var h=b('<input type="checkbox" name="'+d+'">').prependTo(c).click(function(){var m=b(this);var l=m.attr("name");var i=f.options.fields[l];if(i.visibility=="fixed"){return}f.changeColumnVisibility(l,m.is(":checked")?"visible":"hidden")});if(k.visibility!="hidden"){h.attr("checked","checked")}if(k.visibility=="fixed"){h.attr("disabled","disabled")}}this._$columnSelectionDiv.html(e)},_createColumnResizeBar:function(){this._$columnResizeBar=b('<div class="jtable-column-resize-bar" style="position: fixed; top: -100px; left: -100px;"></div>').appendTo(this._$mainContainer).hide()},_makeColumnResizable:function(d){var c=this;b('<div class="jtable-column-resize-handler"></div>').appendTo(d.find(".jtable-column-header-container")).mousedown(function(g){g.preventDefault();g.stopPropagation();var f=d.nextAll("th.jtable-column-header:visible:first");if(!f.length){return}var i=10;c._currentResizeArgs={currentColumnStartWidth:d.outerWidth(),minWidth:i,maxWidth:d.outerWidth()+f.outerWidth()-i,mouseStartX:g.pageX,minResizeX:function(){return this.mouseStartX-(this.currentColumnStartWidth-this.minWidth)},maxResizeX:function(){return this.mouseStartX+(this.maxWidth-this.currentColumnStartWidth)}};var e=function(j){if(!c._currentResizeArgs){return}var k=c._normalizeNumber(j.pageX,c._currentResizeArgs.minResizeX(),c._currentResizeArgs.maxResizeX());c._$columnResizeBar.css("left",k+"px")};var h=function(m){if(!c._currentResizeArgs){return}b(document).unbind("mousemove",e);b(document).unbind("mouseup",h);c._$columnResizeBar.hide();var k=m.pageX-c._currentResizeArgs.mouseStartX;var n=c._normalizeNumber(c._currentResizeArgs.currentColumnStartWidth+k,c._currentResizeArgs.minWidth,c._currentResizeArgs.maxWidth);var l=f.outerWidth()+(c._currentResizeArgs.currentColumnStartWidth-n);var j=d.data("width-in-percent")/c._currentResizeArgs.currentColumnStartWidth;d.data("width-in-percent",n*j);f.data("width-in-percent",l*j);d.css("width",d.data("width-in-percent")+"%");f.css("width",f.data("width-in-percent")+"%");c._normalizeColumnWidths();c._currentResizeArgs=null;if(c.options.saveUserPreferences){c._saveColumnSettings()}};c._$columnResizeBar.show().css({top:(d.offset().top-b(document).scrollTop())+"px",left:(g.pageX-b(document).scrollLeft())+"px",height:c._$table.height()+"px"});b(document).bind("mousemove",e);b(document).bind("mouseup",h)})},_normalizeColumnWidths:function(){var g=this._$table.find("thead th.jtable-command-column-header").data("width-in-percent",1).css("width","1%");var c=this._$table.find("thead th.jtable-column-header");var e=0;c.each(function(){var h=b(this);if(h.is(":visible")){e+=h.outerWidth()}});var f={};var d=100-g.length;c.each(function(){var i=b(this);if(i.is(":visible")){var j=i.data("fieldName");var h=i.outerWidth()*d/e;f[j]=h}});c.each(function(){var h=b(this);if(h.is(":visible")){var i=h.data("fieldName");h.data("width-in-percent",f[i]).css("width",f[i]+"%")}})},_saveColumnSettings:function(){var c=this;var d="";this._$table.find("thead th.jtable-column-header").each(function(){var h=b(this);var i=h.data("fieldName");var g=h.data("width-in-percent");var e=c.options.fields[i].visibility;var f=i+"="+e+";"+g;d=d+f+"|"});this._setCookie("column-settings",d.substr(0,d.length-1));this._logDebug("saved")},_loadColumnSettings:function(){var e=this;var c=this._getCookie("column-settings");if(!c){return}var f={};b.each(c.split("|"),function(i,h){var k=h.split("=");var j=k[0];var g=k[1].split(";");f[j]={columnVisibility:g[0],columnWidth:g[1]}});var d=this._$table.find("thead th.jtable-column-header");d.each(function(){var g=b(this);var i=g.data("fieldName");var h=e.options.fields[i];if(f[i]){if(h.visibility!="fixed"){e._changeColumnVisibilityInternal(i,f[i].columnVisibility)}g.data("width-in-percent",f[i].columnWidth).css("width",f[i].columnWidth+"%")}});this._logDebug("loaded")},_setCookie:function(d,e){d=this._cookieKeyPrefix+d;var c=new Date();c.setDate(c.getDate()+30);document.cookie=encodeURIComponent(d)+"="+encodeURIComponent(e)+"; expires="+c.toUTCString()},_getCookie:function(e){e=this._cookieKeyPrefix+e;var c=document.cookie.split("; ");for(var d=0;d<c.length;d++){if(!c[d]){continue}var f=c[d].split("=");if(f.length!=2){continue}if(decodeURIComponent(f[0])===e){return decodeURIComponent(f[1]||"")}}return null},_generateCookieKeyPrefix:function(){var c=function(g){var h=0;if(g.length==0){return h}for(var e=0;e<g.length;e++){var f=g.charCodeAt(e);h=((h<<5)-h)+f;h=h&h}return h};var d="";if(this.options.tableId){d=d+this.options.tableId+"#"}d=d+this._columnList.join("$")+"#c"+this._$table.find("thead th").length;return"jtable#"+c(d)}})})(jQuery);(function(b){var a={_removeRowsFromTable:b.hik.jtable.prototype._removeRowsFromTable};b.extend(true,b.hik.jtable.prototype,{options:{openChildAsAccordion:false},openChildTable:function(d,c,f){var e=this;c.showCloseButton=(c.showCloseButton!=false);if(c.showCloseButton&&!c.closeRequested){c.closeRequested=function(){e.closeChildTable(d)}}if(e.options.openChildAsAccordion){d.siblings().each(function(){e.closeChildTable(b(this))})}e.closeChildTable(d,function(){var h=e.getChildRow(d).find("td").empty();var g=b('<div class="jtable-child-table-container"></div>').appendTo(h);h.data("childTable",g);g.jtable(c);e.openChildRow(d);g.hide().slideDown("fast",function(){if(f){f({childTable:g})}})})},closeChildTable:function(c,f){var e=this;var g=this.getChildRow(c).find("td");var d=g.data("childTable");if(!d){if(f){f()}return}g.data("childTable",null);d.slideUp("fast",function(){d.jtable("destroy");d.remove();e.closeChildRow(c);if(f){f()}})},isChildRowOpen:function(c){return(this.getChildRow(c).is(":visible"))},getChildRow:function(c){return c.data("childRow")||this._createChildRow(c)},openChildRow:function(c){var d=this.getChildRow(c);if(!d.is(":visible")){d.show()}return d},closeChildRow:function(c){var d=this.getChildRow(c);if(d.is(":visible")){d.hide()}},_removeRowsFromTable:function(d,e){var c=this;if(e=="deleted"){d.each(function(){var f=b(this);var g=f.data("childRow");if(g){c.closeChildTable(f);g.remove()}})}a._removeRowsFromTable.apply(this,arguments)},_createChildRow:function(d){var e=this._findRowIndex(d);var c=this._$table.find("thead th").length;var f=b('<tr class="jtable-child-row"></tr>').append('<td colspan="'+c+'"></td>');this._addRowToTable(f,e+1);d.data("childRow",f);f.hide();return f}})})(jQuery);